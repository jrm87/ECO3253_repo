<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Data Wrangling | Economics of Public and Social Issues</title>
  <meta name="description" content="This is the website for the course ECO 3253 at UTSA, taught in the Fall of 2022." />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Data Wrangling | Economics of Public and Social Issues" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is the website for the course ECO 3253 at UTSA, taught in the Fall of 2022." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Data Wrangling | Economics of Public and Social Issues" />
  
  <meta name="twitter:description" content="This is the website for the course ECO 3253 at UTSA, taught in the Fall of 2022." />
  

<meta name="author" content="Jonathan Moreno-Medina" />


<meta name="date" content="2022-08-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="viz.html"/>
<link rel="next" href="appendixA.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Eco of Public and Social Issues (ECO 3253), Fall 2022</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#aboutme"><i class="fa fa-check"></i>About me</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#organization-of-this-site"><i class="fa fa-check"></i>Organization of this site</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#data-driven-course"><i class="fa fa-check"></i>Data-driven course</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#topics-to-be-covered"><i class="fa fa-check"></i>Topics to be covered</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#statistical-tools"><i class="fa fa-check"></i>Statistical tools</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#economic-concepts"><i class="fa fa-check"></i>Economic Concepts</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#projects"><i class="fa fa-check"></i>Projects</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#faqs"><i class="fa fa-check"></i>FAQs</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html"><i class="fa fa-check"></i>Updated Schedule</a></li>
<li class="part"><span><b>I Ec. &amp; Soc. Issues</b></span></li>
<li class="chapter" data-level="1" data-path="upward-mobility-in-the-us.html"><a href="upward-mobility-in-the-us.html"><i class="fa fa-check"></i><b>1</b> Upward Mobility in the US</a>
<ul>
<li class="chapter" data-level="1.1" data-path="upward-mobility-in-the-us.html"><a href="upward-mobility-in-the-us.html#parental-and-children-income-rank"><i class="fa fa-check"></i><b>1.1</b> Parental and children income rank</a></li>
<li class="chapter" data-level="1.2" data-path="upward-mobility-in-the-us.html"><a href="upward-mobility-in-the-us.html#interpreting-the-regression-line"><i class="fa fa-check"></i><b>1.2</b> Interpreting the regression line</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="upward-mobility-in-the-us.html"><a href="upward-mobility-in-the-us.html#percentiles"><i class="fa fa-check"></i><b>1.2.1</b> Percentiles</a></li>
<li class="chapter" data-level="1.2.2" data-path="upward-mobility-in-the-us.html"><a href="upward-mobility-in-the-us.html#what-is-a-tract"><i class="fa fa-check"></i><b>1.2.2</b> What is a tract?</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="upward-mobility-in-the-us.html"><a href="upward-mobility-in-the-us.html#geographic-variation-in-upward-mobility-by-commuting-zone"><i class="fa fa-check"></i><b>1.3</b> Geographic Variation in Upward Mobility by Commuting Zone</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="upward-mobility-in-the-us.html"><a href="upward-mobility-in-the-us.html#adjustments-for-cost-of-living"><i class="fa fa-check"></i><b>1.3.1</b> Adjustments for cost of living</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="upward-mobility-in-the-us.html"><a href="upward-mobility-in-the-us.html#local-area-variation-in-upward-mobility-los-angeles-ca"><i class="fa fa-check"></i><b>1.4</b> Local Area Variation in Upward Mobility: Los Angeles, CA</a></li>
</ul></li>
<li class="part"><span><b>II Tools</b></span></li>
<li class="chapter" data-level="2" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>2</b> Very Brief Intro to Data in R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started.html"><a href="getting-started.html#why-r-again"><i class="fa fa-check"></i><b>2.1</b> Why R again?</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="getting-started.html"><a href="getting-started.html#why-are-we-learning-r-i-wanted-to-learn-about-economics-of-public-and-social-issues"><i class="fa fa-check"></i><b>2.1.1</b> Why are we learning R? I wanted to learn about economics of public and social issues…</a></li>
<li class="chapter" data-level="2.1.2" data-path="getting-started.html"><a href="getting-started.html#ok-but-why-r"><i class="fa fa-check"></i><b>2.1.2</b> Ok, but why R?</a></li>
<li class="chapter" data-level="2.1.3" data-path="getting-started.html"><a href="getting-started.html#added-benefits-of-learning-r"><i class="fa fa-check"></i><b>2.1.3</b> Added benefits of learning R</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="getting-started.html"><a href="getting-started.html#key-concepts-before-we-start"><i class="fa fa-check"></i><b>2.2</b> Key concepts before we start:</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="getting-started.html"><a href="getting-started.html#r-rstudio"><i class="fa fa-check"></i><b>2.2.1</b> What are R and RStudio?</a></li>
<li class="chapter" data-level="2.2.2" data-path="getting-started.html"><a href="getting-started.html#r-and-rstudio-in-your-computer-or-in-the-cloud"><i class="fa fa-check"></i><b>2.2.2</b> R and RStudio: In your computer or in the cloud?</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="getting-started.html"><a href="getting-started.html#lets-open-r"><i class="fa fa-check"></i><b>2.3</b> Let’s open R!</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="getting-started.html"><a href="getting-started.html#rstudio-in-the-cloud"><i class="fa fa-check"></i><b>2.3.1</b> RStudio in the cloud</a></li>
<li class="chapter" data-level="2.3.2" data-path="getting-started.html"><a href="getting-started.html#using-r-via-rstudio"><i class="fa fa-check"></i><b>2.3.2</b> Using R via RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="getting-started.html"><a href="getting-started.html#code"><i class="fa fa-check"></i><b>2.4</b> How do I code in R?</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="getting-started.html"><a href="getting-started.html#programming-concepts"><i class="fa fa-check"></i><b>2.4.1</b> Basic programming concepts and terminology</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="getting-started.html"><a href="getting-started.html#in-class-exercise"><i class="fa fa-check"></i><b>2.5</b> In Class Exercise</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="getting-started.html"><a href="getting-started.html#errors-warnings-and-messages"><i class="fa fa-check"></i><b>2.5.1</b> Errors, warnings, and messages</a></li>
<li class="chapter" data-level="2.5.2" data-path="getting-started.html"><a href="getting-started.html#tips-on-learning-to-code"><i class="fa fa-check"></i><b>2.5.2</b> Tips on learning to code</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="getting-started.html"><a href="getting-started.html#packages"><i class="fa fa-check"></i><b>2.6</b> What are R packages?</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="getting-started.html"><a href="getting-started.html#package-installation"><i class="fa fa-check"></i><b>2.6.1</b> Package installation</a></li>
<li class="chapter" data-level="2.6.2" data-path="getting-started.html"><a href="getting-started.html#package-loading"><i class="fa fa-check"></i><b>2.6.2</b> Package loading</a></li>
<li class="chapter" data-level="2.6.3" data-path="getting-started.html"><a href="getting-started.html#package-use"><i class="fa fa-check"></i><b>2.6.3</b> Package use</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="getting-started.html"><a href="getting-started.html#hands-on-exercise"><i class="fa fa-check"></i><b>2.7</b> Hands-on exercise!</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="getting-started.html"><a href="getting-started.html#mobilitydata"><i class="fa fa-check"></i><b>2.7.1</b> Explore your first dataset: economic mobility in the US</a></li>
<li class="chapter" data-level="2.7.2" data-path="getting-started.html"><a href="getting-started.html#economic-mobility-data"><i class="fa fa-check"></i><b>2.7.2</b> Economic mobility data</a></li>
<li class="chapter" data-level="2.7.3" data-path="getting-started.html"><a href="getting-started.html#atlas-data-frame"><i class="fa fa-check"></i><b>2.7.3</b> <code>atlas</code> data frame</a></li>
<li class="chapter" data-level="2.7.4" data-path="getting-started.html"><a href="getting-started.html#exploredataframes"><i class="fa fa-check"></i><b>2.7.4</b> Exploring data frames</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="getting-started.html"><a href="getting-started.html#conclusion"><i class="fa fa-check"></i><b>2.8</b> Conclusion</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="getting-started.html"><a href="getting-started.html#additional-resources"><i class="fa fa-check"></i><b>2.8.1</b> Additional resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="viz.html"><a href="viz.html"><i class="fa fa-check"></i><b>3</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="" data-path="viz.html"><a href="viz.html#needed-data-and-packages"><i class="fa fa-check"></i>Needed data and packages</a></li>
<li class="chapter" data-level="3.1" data-path="viz.html"><a href="viz.html#grammarofgraphics"><i class="fa fa-check"></i><b>3.1</b> The Grammar of Graphics</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="viz.html"><a href="viz.html#components-of-the-grammar"><i class="fa fa-check"></i><b>3.1.1</b> Components of the Grammar</a></li>
<li class="chapter" data-level="3.1.2" data-path="viz.html"><a href="viz.html#gapminder"><i class="fa fa-check"></i><b>3.1.2</b> Gapminder data</a></li>
<li class="chapter" data-level="3.1.3" data-path="viz.html"><a href="viz.html#other-components"><i class="fa fa-check"></i><b>3.1.3</b> Other components</a></li>
<li class="chapter" data-level="3.1.4" data-path="viz.html"><a href="viz.html#ggplot2-package"><i class="fa fa-check"></i><b>3.1.4</b> ggplot2 package</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="viz.html"><a href="viz.html#FiveNG"><i class="fa fa-check"></i><b>3.2</b> Three Important Graphs -</a></li>
<li class="chapter" data-level="3.3" data-path="viz.html"><a href="viz.html#scatterplots"><i class="fa fa-check"></i><b>3.3</b> Scatterplots</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="viz.html"><a href="viz.html#geompoint"><i class="fa fa-check"></i><b>3.3.1</b> Scatterplots via geom_point</a></li>
<li class="chapter" data-level="3.3.2" data-path="viz.html"><a href="viz.html#overplotting"><i class="fa fa-check"></i><b>3.3.2</b> Over-plotting</a></li>
<li class="chapter" data-level="3.3.3" data-path="viz.html"><a href="viz.html#summary"><i class="fa fa-check"></i><b>3.3.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="viz.html"><a href="viz.html#histograms"><i class="fa fa-check"></i><b>3.4</b> Histograms</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="viz.html"><a href="viz.html#geomhistogram"><i class="fa fa-check"></i><b>3.4.1</b> Histograms via geom_histogram</a></li>
<li class="chapter" data-level="3.4.2" data-path="viz.html"><a href="viz.html#adjustbins"><i class="fa fa-check"></i><b>3.4.2</b> Adjusting the bins</a></li>
<li class="chapter" data-level="3.4.3" data-path="viz.html"><a href="viz.html#summary-1"><i class="fa fa-check"></i><b>3.4.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="viz.html"><a href="viz.html#geombar"><i class="fa fa-check"></i><b>3.5</b> Barplots</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="viz.html"><a href="viz.html#barplots-via-geom_bar-or-geom_col"><i class="fa fa-check"></i><b>3.5.1</b> Barplots via geom_bar or geom_col</a></li>
<li class="chapter" data-level="3.5.2" data-path="viz.html"><a href="viz.html#summary-2"><i class="fa fa-check"></i><b>3.5.2</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="viz.html"><a href="viz.html#conclusion-1"><i class="fa fa-check"></i><b>3.6</b> Conclusion</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="viz.html"><a href="viz.html#summary-table"><i class="fa fa-check"></i><b>3.6.1</b> Summary table</a></li>
<li class="chapter" data-level="3.6.2" data-path="viz.html"><a href="viz.html#argument-specification"><i class="fa fa-check"></i><b>3.6.2</b> Argument specification</a></li>
<li class="chapter" data-level="3.6.3" data-path="viz.html"><a href="viz.html#additional-resources-1"><i class="fa fa-check"></i><b>3.6.3</b> Additional resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="wrangling.html"><a href="wrangling.html"><i class="fa fa-check"></i><b>4</b> Data Wrangling</a>
<ul>
<li class="chapter" data-level="" data-path="wrangling.html"><a href="wrangling.html#needed-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="4.1" data-path="wrangling.html"><a href="wrangling.html#piping"><i class="fa fa-check"></i><b>4.1</b> The pipe operator: <code>%&gt;%</code></a></li>
<li class="chapter" data-level="4.2" data-path="wrangling.html"><a href="wrangling.html#filter"><i class="fa fa-check"></i><b>4.2</b> <code>filter</code> rows</a></li>
<li class="chapter" data-level="4.3" data-path="wrangling.html"><a href="wrangling.html#mutate"><i class="fa fa-check"></i><b>4.3</b> <code>mutate</code> existing variables</a></li>
<li class="chapter" data-level="4.4" data-path="wrangling.html"><a href="wrangling.html#other-verbs"><i class="fa fa-check"></i><b>4.4</b> Other verbs</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="wrangling.html"><a href="wrangling.html#select"><i class="fa fa-check"></i><b>4.4.1</b> <code>select</code> variables</a></li>
<li class="chapter" data-level="4.4.2" data-path="wrangling.html"><a href="wrangling.html#rename"><i class="fa fa-check"></i><b>4.4.2</b> <code>rename</code> variables</a></li>
<li class="chapter" data-level="4.4.3" data-path="wrangling.html"><a href="wrangling.html#top_n-values-of-a-variable"><i class="fa fa-check"></i><b>4.4.3</b> <code>top_n</code> values of a variable</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="wrangling.html"><a href="wrangling.html#conclusion-2"><i class="fa fa-check"></i><b>4.5</b> Conclusion</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="wrangling.html"><a href="wrangling.html#additional-resources-2"><i class="fa fa-check"></i><b>4.5.1</b> Additional resources</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="appendixA.html"><a href="appendixA.html"><i class="fa fa-check"></i><b>A</b> Statistical Background</a>
<ul>
<li class="chapter" data-level="A.1" data-path="appendixA.html"><a href="appendixA.html#basic-statistical-terms"><i class="fa fa-check"></i><b>A.1</b> Basic statistical terms</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="appendixA.html"><a href="appendixA.html#mean"><i class="fa fa-check"></i><b>A.1.1</b> Mean</a></li>
<li class="chapter" data-level="A.1.2" data-path="appendixA.html"><a href="appendixA.html#median"><i class="fa fa-check"></i><b>A.1.2</b> Median</a></li>
<li class="chapter" data-level="A.1.3" data-path="appendixA.html"><a href="appendixA.html#standard-deviation"><i class="fa fa-check"></i><b>A.1.3</b> Standard deviation</a></li>
<li class="chapter" data-level="A.1.4" data-path="appendixA.html"><a href="appendixA.html#five-number-summary"><i class="fa fa-check"></i><b>A.1.4</b> Five-number summary</a></li>
<li class="chapter" data-level="A.1.5" data-path="appendixA.html"><a href="appendixA.html#appPercentiles"><i class="fa fa-check"></i><b>A.1.5</b> Percentiles or rank</a></li>
<li class="chapter" data-level="A.1.6" data-path="appendixA.html"><a href="appendixA.html#appDistributions"><i class="fa fa-check"></i><b>A.1.6</b> Distribution</a></li>
<li class="chapter" data-level="A.1.7" data-path="appendixA.html"><a href="appendixA.html#outliers"><i class="fa fa-check"></i><b>A.1.7</b> Outliers</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Projects</b></span></li>
<li class="chapter" data-level="" data-path="project1.html"><a href="project1.html"><i class="fa fa-check"></i>Project 1</a>
<ul>
<li class="chapter" data-level="" data-path="project1.html"><a href="project1.html#stories-from-the-atlas-describing-data-using-maps-regressions-and-correlations"><i class="fa fa-check"></i>Stories from the Atlas: Describing Data using Maps, Regressions, and Correlations</a></li>
<li class="chapter" data-level="" data-path="project1.html"><a href="project1.html#instructions"><i class="fa fa-check"></i>Instructions</a>
<ul>
<li class="chapter" data-level="" data-path="project1.html"><a href="project1.html#specific-questions-to-address-in-your-narrative"><i class="fa fa-check"></i>Specific questions to address in your narrative</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="project1.html"><a href="project1.html#data-description"><i class="fa fa-check"></i>Data Description</a></li>
<li class="chapter" data-level="" data-path="project1.html"><a href="project1.html#cheatsheetproject1"><i class="fa fa-check"></i>Cheatsheat commands</a>
<ul>
<li class="chapter" data-level="" data-path="project1.html"><a href="project1.html#unweighted-summary-statistics"><i class="fa fa-check"></i>Unweighted summary statistics</a></li>
<li class="chapter" data-level="" data-path="project1.html"><a href="project1.html#load-package"><i class="fa fa-check"></i>Load package</a></li>
<li class="chapter" data-level="" data-path="project1.html"><a href="project1.html#weighted-summary-statistics"><i class="fa fa-check"></i>Weighted summary statistics</a></li>
<li class="chapter" data-level="" data-path="project1.html"><a href="project1.html#subset-observations"><i class="fa fa-check"></i>Subset observations</a></li>
<li class="chapter" data-level="" data-path="project1.html"><a href="project1.html#standardize-variables"><i class="fa fa-check"></i>Standardize variables</a></li>
<li class="chapter" data-level="" data-path="project1.html"><a href="project1.html#run-regression"><i class="fa fa-check"></i>Run regression</a></li>
<li class="chapter" data-level="" data-path="project1.html"><a href="project1.html#how-to-read-the-regression-output"><i class="fa fa-check"></i>How to read the regression output?</a></li>
<li class="chapter" data-level="" data-path="project1.html"><a href="project1.html#plotting-the-linear-relationship"><i class="fa fa-check"></i>Plotting the linear relationship</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://www.jmorenomedina.com/" target="blank">By Jon Moreno-Medina</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Economics of Public and Social Issues</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="wrangling" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Data Wrangling<a href="wrangling.html#wrangling" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>So far in our journey, we’ve seen how to look at data saved in data frames using the <code>glimpse()</code> and <code>View()</code> functions in Chapter <a href="getting-started.html#getting-started">2</a> on and how to create data visualizations using the <code>ggplot2</code> package in Chapter <a href="viz.html#viz">3</a>. In particular we studied what we term the the following three graphs:</p>
<ol style="list-style-type: decimal">
<li>scatterplots via <code>geom_point()</code></li>
<li>histograms via <code>geom_histogram()</code></li>
<li>barplots via <code>geom_bar()</code> or <code>geom_col()</code></li>
</ol>
<p>We created these visualizations using the “Grammar of Graphics”, which maps variables in a data frame to the aesthetic attributes of one the above 3 <code>geom</code>etric objects. We can also control other aesthetic attributes of the geometric objects such as the size and color as seen in the Gapminder data example in Figure <a href="viz.html#fig:gapminder">3.1</a>.</p>
<p>Recall however in Section <a href="#whats-to-come-3"><strong>??</strong></a> we discussed that for two of our visualizations we needed transformed/modified versions of existing data frames. Recall for example the scatterplot of economic mobility <em>only</em> for neighborhoods in Wisconsin. In order to create this visualization, we needed to first pare down the <code>atlas</code> data frame to a new data frame <code>atlas_wisconsin.</code> consisting of only <code>state == 55</code> neighborhoods using the <code>filter()</code> function.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="wrangling.html#cb32-1" aria-hidden="true" tabindex="-1"></a>atlas_wisconsin <span class="ot">&lt;-</span> atlas <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a href="wrangling.html#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="dv">55</span>)</span>
<span id="cb32-3"><a href="wrangling.html#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="wrangling.html#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> atlas_wisconsin, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> med_hhinc2016, <span class="at">y =</span> kfr_pooled_p25)) <span class="sc">+</span> </span>
<span id="cb32-5"><a href="wrangling.html#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p>In this chapter, we’ll introduce <strong>two</strong> very useful functions from the <code>dplyr</code> package that will allow you to take a data frame and</p>
<ol style="list-style-type: decimal">
<li><code>filter()</code> its existing rows to only pick out a subset of them. For example, the <code>atlas_wisconsin</code> data frame above.</li>
<li><code>mutate()</code> its existing columns/variables to create new ones. For example, convert hourly temperature recordings from °F to °C.</li>
</ol>
<p>There are other functions we will not cover here, but that could be really useful for you to know if you ever get to work with data outside this course: <code>summarize()</code>, <code>group_by()</code>, <code>arrange()</code> and <code>join()</code>. I will leave those to learn on your own if you want to. You can check <a href="https://nustat.github.io/intro-stat-ds/4-tidy.html">this very good explanation</a>.</p>
<p>Back to our functions! Notice how we used <code>computer code</code> font to describe the actions we want to take on our data frames. This is because the <code>dplyr</code> package for data wrangling that we’ll introduce in this chapter has intuitively verb-named functions that are easy to remember.</p>
<p>We’ll start by introducing the pipe operator <code>%&gt;%</code>, which allows you to combine multiple data wrangling verb-named functions into a single sequential <em>chain</em> of actions.</p>
<div id="needed-packages" class="section level3 unnumbered hasAnchor">
<h3>Needed packages<a href="wrangling.html#needed-packages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s load all the packages needed for this chapter (this assumes you’ve already installed them). If needed, read Section <a href="getting-started.html#packages">2.6</a> for information on how to install and load R packages. We will also load the <code>atlas</code> data once more.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="wrangling.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb33-2"><a href="wrangling.html#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb33-3"><a href="wrangling.html#cb33-3" aria-hidden="true" tabindex="-1"></a>atlas <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">gzcon</span>(<span class="fu">url</span>(<span class="st">&quot;https://raw.githubusercontent.com/jrm87/ECO3253_repo/master/data/atlas.rds&quot;</span>)))</span></code></pre></div>
<hr />
</div>
<div id="piping" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> The pipe operator: <code>%&gt;%</code><a href="wrangling.html#piping" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before we start data wrangling, let’s first introduce a very nifty tool that gets loaded along with the <code>dplyr</code> package: the pipe operator <code>%&gt;%</code>. Say you would like to perform a hypothetical sequence of operations on a hypothetical data frame <code>x</code> using hypothetical functions <code>f()</code>, <code>g()</code>, and <code>h()</code>:</p>
<ol style="list-style-type: decimal">
<li>Take <code>x</code> <em>then</em></li>
<li>Use <code>x</code> as an input to a function <code>f()</code> <em>then</em></li>
<li>Use the output of <code>f(x)</code> as an input to a function <code>g()</code> <em>then</em></li>
<li>Use the output of <code>g(f(x))</code> as an input to a function <code>h()</code></li>
</ol>
<p>One way to achieve this sequence of operations is by using nesting parentheses as follows:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="wrangling.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">h</span>(<span class="fu">g</span>(<span class="fu">f</span>(x)))</span></code></pre></div>
<p>The above code isn’t so hard to read since we are applying only three functions: <code>f()</code>, then <code>g()</code>, then <code>h()</code>. However, you can imagine that this can get progressively harder and harder to read as the number of functions applied in your sequence increases. This is where the pipe operator <code>%&gt;%</code> comes in handy. <code>%&gt;%</code> takes one output of one function and then “pipes” it to be the input of the next function. Furthermore, a helpful trick is to read <code>%&gt;%</code> as “then.” For example, you can obtain the same output as the above sequence of operations as follows:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="wrangling.html#cb35-1" aria-hidden="true" tabindex="-1"></a>x <span class="sc">%&gt;%</span> </span>
<span id="cb35-2"><a href="wrangling.html#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">f</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb35-3"><a href="wrangling.html#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">g</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb35-4"><a href="wrangling.html#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">h</span>()</span></code></pre></div>
<p>You would read this above sequence as:</p>
<ol style="list-style-type: decimal">
<li>Take <code>x</code> <em>then</em></li>
<li>Use this output as the input to the next function <code>f()</code> <em>then</em></li>
<li>Use this output as the input to the next function <code>g()</code> <em>then</em></li>
<li>Use this output as the input to the next function <code>h()</code></li>
</ol>
<p>So while both approaches above would achieve the same goal, the latter is much more human-readable because you can read the sequence of operations line-by-line. But what are the hypothetical <code>x</code>, <code>f()</code>, <code>g()</code>, and <code>h()</code>? Throughout this chapter on data wrangling:</p>
<ul>
<li>The starting value <code>x</code> will be a data frame. For example: <code>atlas</code>.</li>
<li>The sequence of functions, here <code>f()</code>, <code>g()</code>, and <code>h()</code>, will be a sequence of any number of the 6 data wrangling verb-named functions we listed in the introduction to this chapter. For example: <code>filter(state == 55)</code>.</li>
<li>The result will be the transformed/modified data frame that you want. For example: a data frame consisting of only the subset of rows in <code>atlas</code> corresponding to neighborhoods in the State of Wisconsin.</li>
</ul>
<p>Much like when adding layers to a <code>ggplot()</code> using the <code>+</code> sign at the end of lines, you form a single <em>chain</em> of data wrangling operations by combining verb-named functions into a single sequence with pipe operators <code>%&gt;%</code> at the end of lines. So continuing our example involving neighborhoods in Wisconsin, we form a chain using the pipe operator <code>%&gt;%</code> and save the resulting data frame in <code>atlas_wisconsin</code>:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="wrangling.html#cb36-1" aria-hidden="true" tabindex="-1"></a>atlas_wisconsin <span class="ot">&lt;-</span> atlas <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="wrangling.html#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="dv">55</span>)</span></code></pre></div>
<p>Keep in mind, there are many more advanced data wrangling functions than just the 2 listed in the introduction to this chapter; you’ll see some examples of these in Section <a href="wrangling.html#other-verbs">4.4</a>. However, just with these 2 verb-named functions you’ll be able to perform a broad array of data wrangling tasks for the rest of this course.</p>
<hr />
</div>
<div id="filter" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> <code>filter</code> rows<a href="wrangling.html#filter" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:filter"></span>
<img src="images/filter.png" alt="Diagram of " width="\textwidth" />
<p class="caption">
Figure 4.1: Diagram of
</p>
</div>
<p>The <code>filter()</code> function here works much like the “Filter” option in Microsoft Excel; it allows you to specify criteria about the values of a variable in your dataset and then filters out only those rows that match that criteria. We begin by focusing only on neighborhoods from the state of North Carolina. The <code>state</code> code (or airport code) for Portland, Oregon is <code>37</code>. Run the following and look at the resulting spreadsheet to ensure that only neighborhoods from North Carolina are chosen here:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="wrangling.html#cb37-1" aria-hidden="true" tabindex="-1"></a>atlas_nc<span class="ot">&lt;-</span> atlas <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="wrangling.html#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="dv">37</span>)</span>
<span id="cb37-3"><a href="wrangling.html#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(atlas_nc)</span></code></pre></div>
<p>Note the following:</p>
<ul>
<li>The ordering of the commands:
<ul>
<li>Take the <code>atlas</code> data frame <em>then</em></li>
<li><code>filter</code> the data frame so that only thosewith <code>state</code> equals <code>37</code> are included.</li>
</ul></li>
<li>We test for equality using the double equal sign <code>==</code> and not a single equal sign <code>=</code>. In other words <code>filter(state = 37)</code> will yield an error. This is a convention across many programming languages. If you are new to coding, you’ll probably forget to use the double equal sign <code>==</code> a few times before you get the hang of it.</li>
</ul>
<p>You can use other mathematical operations beyond just <code>==</code> to form criteria:</p>
<ul>
<li><code>&gt;</code> corresponds to “greater than”</li>
<li><code>&lt;</code> corresponds to “less than”</li>
<li><code>&gt;=</code> corresponds to “greater than or equal to”</li>
<li><code>&lt;=</code> corresponds to “less than or equal to”</li>
<li><code>!=</code> corresponds to “not equal to”. The <code>!</code> is used in many programming languages to indicate “not”.</li>
</ul>
<p>Furthermore, you can combine multiple criteria together using operators that make comparisons:</p>
<ul>
<li><code>|</code> corresponds to “or”</li>
<li><code>&amp;</code> corresponds to “and”</li>
</ul>
<p>To see many of these in action, let’s filter <code>atlas</code> for all rows that:</p>
<ul>
<li>Had a mean household income over 30,000 in the year 2000 and</li>
<li>Are in North Carolina or Massachusetts; and</li>
<li>Had an employment rate in the year 2000 of at least 80%</li>
</ul>
<p>Run the following:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="wrangling.html#cb38-1" aria-hidden="true" tabindex="-1"></a>atlas_filter1 <span class="ot">&lt;-</span> atlas <span class="sc">%&gt;%</span> </span>
<span id="cb38-2"><a href="wrangling.html#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hhinc_mean2000 <span class="sc">&gt;</span><span class="dv">30000</span> <span class="sc">&amp;</span> (state <span class="sc">==</span><span class="dv">37</span>  <span class="sc">|</span> state <span class="sc">==</span> <span class="dv">25</span>) <span class="sc">&amp;</span> emp2000 <span class="sc">&gt;=</span> <span class="fl">0.8</span>)</span>
<span id="cb38-3"><a href="wrangling.html#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(atlas_filter1)</span></code></pre></div>
<p>Note that even though colloquially speaking one might say “all neighborhoods from North Carolina <strong>and</strong> Massachusetts” in terms of computer operations, we really mean “all neighborhoods from North Carolina <strong>or</strong> Massachusetts.” For a given row in the data, <code>state</code> can be <code>37</code>, <code>25</code>, or something else, but not <code>37</code> and <code>25</code> at the same time. Furthermore, note the careful use of parentheses around the <code>state ==37  | state == 25</code>.</p>
<p>We can often skip the use of <code>&amp;</code> and just separate our conditions with a comma. In other words the code above will return the identical output <code>atlas_filter1</code> as this code below:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="wrangling.html#cb39-1" aria-hidden="true" tabindex="-1"></a>atlas_filter1 <span class="ot">&lt;-</span> atlas <span class="sc">%&gt;%</span> </span>
<span id="cb39-2"><a href="wrangling.html#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hhinc_mean2000 <span class="sc">&gt;</span><span class="dv">30000</span>, (state <span class="sc">==</span><span class="dv">37</span>  <span class="sc">|</span> state <span class="sc">==</span> <span class="dv">25</span>), emp2000 <span class="sc">&gt;=</span> <span class="fl">0.8</span>)</span>
<span id="cb39-3"><a href="wrangling.html#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(atlas_filter1)</span></code></pre></div>
<p>Let’s present another example that uses the <code>!</code> “not” operator to pick rows that <em>don’t</em> match a criteria. As mentioned earlier, the <code>!</code> can be read as “not.” Here we are filtering rows corresponding to neighborhoods that are <strong>not</strong> in North Carolina or Massachusetts.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="wrangling.html#cb40-1" aria-hidden="true" tabindex="-1"></a>atlas_not_nc_ma <span class="ot">&lt;-</span> atlas <span class="sc">%&gt;%</span> </span>
<span id="cb40-2"><a href="wrangling.html#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(state <span class="sc">==</span><span class="dv">37</span>  <span class="sc">|</span> state <span class="sc">==</span> <span class="dv">25</span>))</span>
<span id="cb40-3"><a href="wrangling.html#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(atlas_not_nc_ma)</span></code></pre></div>
<p>Again, note the careful use of parentheses around the <code>(state ==37  | state == 25)</code>. If we didn’t use parentheses as follows:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="wrangling.html#cb41-1" aria-hidden="true" tabindex="-1"></a>atlas <span class="sc">%&gt;%</span> </span>
<span id="cb41-2"><a href="wrangling.html#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>state <span class="sc">==</span><span class="dv">37</span>  <span class="sc">|</span> state <span class="sc">==</span> <span class="dv">25</span>)</span></code></pre></div>
<p>We would be returning all neighborhoods not in <code>37</code> <em>or</em> those in <code>25</code>, which is an entirely different resulting data frame.</p>
<p>Now say we have a large list of airports we want to filter for, say NC (<code>37</code>), MA (<code>25</code>), FL(<code>12</code>) and PA(<code>42</code>). We could continue to use the <code>|</code> or operator as so:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="wrangling.html#cb42-1" aria-hidden="true" tabindex="-1"></a>atlas_many_states <span class="ot">&lt;-</span> atlas <span class="sc">%&gt;%</span> </span>
<span id="cb42-2"><a href="wrangling.html#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span><span class="dv">37</span>  <span class="sc">|</span> state <span class="sc">==</span> <span class="dv">25</span> <span class="sc">|</span> state <span class="sc">==</span> <span class="dv">12</span> <span class="sc">|</span> state <span class="sc">==</span> <span class="dv">42</span>)</span>
<span id="cb42-3"><a href="wrangling.html#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(atlas_many_states)</span></code></pre></div>
<p>but as we progressively include more airports, this will get unwieldy. A slightly shorter approach uses the <code>%in%</code> operator:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="wrangling.html#cb43-1" aria-hidden="true" tabindex="-1"></a>atlas_many_states <span class="ot">&lt;-</span> atlas <span class="sc">%&gt;%</span> </span>
<span id="cb43-2"><a href="wrangling.html#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">37</span>, <span class="dv">25</span>, <span class="dv">12</span>, <span class="dv">42</span>))</span>
<span id="cb43-3"><a href="wrangling.html#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(atlas_many_states)</span></code></pre></div>
<p>What this code is doing is filtering <code>atlas</code> for all neighborhoods where <code>state</code> is in the list of airports <code>c(37, 25, 12, 42)</code>. Recall from Chapter <a href="getting-started.html#getting-started">2</a> that the <code>c()</code> function “combines” or “concatenates” values in a vector of values. Both outputs of <code>atlas_many_states</code> are the same, but as you can see the latter takes much less time to code.</p>
<p>As a final note we point out that <code>filter()</code> should often be among the first verbs you apply to your data. This cleans your dataset to only those rows you care about, or put differently, it narrows down the scope of your data frame to just the observations your care about.</p>
<hr />
<hr />
</div>
<div id="mutate" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> <code>mutate</code> existing variables<a href="wrangling.html#mutate" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:select"></span>
<img src="images/mutate.png" alt="Mutate diagram from Data Wrangling with dplyr and tidyr cheatsheet" width="\textwidth" />
<p class="caption">
Figure 4.2: Mutate diagram from Data Wrangling with dplyr and tidyr cheatsheet
</p>
</div>
<p>A common transformation of data is to create/compute new variables based on existing ones. For example, say you are more comfortable thinking of income in terms of the logarithm of income instead of in dollars. We will apply this to the variable <code>hhinc_mean2000</code> (the mean household income in 2000). You want to implement the following formula:</p>
<p><span class="math display">\[
\text{income} = log(\text{income})
\]</span></p>
<p>We can apply this formula to the <code>hhinc_mean2000</code> variable using the <code>mutate()</code> function, which takes existing variables and mutates them to create new ones.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="wrangling.html#cb44-1" aria-hidden="true" tabindex="-1"></a>atlas <span class="ot">&lt;-</span> atlas <span class="sc">%&gt;%</span> </span>
<span id="cb44-2"><a href="wrangling.html#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_hhinc_mean2000=</span> <span class="fu">log</span>(hhinc_mean2000))</span>
<span id="cb44-3"><a href="wrangling.html#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(atlas)</span></code></pre></div>
<p>Note that we have overwritten the original <code>atlas</code> data frame with a new version that now includes the additional variable <code>log_hhinc_mean2000</code>. In other words, the <code>mutate()</code> command outputs a new data frame which then gets saved over the original <code>atlas</code> data frame. Furthermore, note how in <code>mutate()</code> we used <code>log_hhinc_mean2000= log(hhinc_mean2000)</code> to create a new variable <code>log_hhinc_mean2000</code>.</p>
<p>Why did we overwrite the data frame <code>atlas</code> instead of assigning the result to a new data frame like <code>atlas_new</code>, but on the other hand why did we <em>not</em> overwrite <code>hhinc_mean2000</code>, but instead created a new variable called <code>temp_in_C</code>? As a rough rule of thumb, as long as you are not losing original information that you might need later, it’s acceptable practice to overwrite existing data frames. On the other hand, had we used <code>mutate(hhinc_mean2000 = log(hhinc_mean2000)</code> instead of <code>mutate(log_hhinc_mean2000= log(hhinc_mean2000))</code>, we would have overwritten the original variable <code>hhinc_mean2000</code> and lost its values.</p>
<hr />
<hr />
</div>
<div id="other-verbs" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Other verbs<a href="wrangling.html#other-verbs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here are some other useful data wrangling verbs that might come in handy:</p>
<ul>
<li><code>select()</code> only a subset of variables/columns</li>
<li><code>rename()</code> variables/columns to have new names</li>
<li>Return only the <code>top_n()</code> values of a variable</li>
</ul>
<div id="select" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> <code>select</code> variables<a href="wrangling.html#select" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:selectfig"></span>
<img src="images/select.png" alt="Select diagram from Data Wrangling with dplyr and tidyr cheatsheet" width="\textwidth" />
<p class="caption">
Figure 4.3: Select diagram from Data Wrangling with dplyr and tidyr cheatsheet
</p>
</div>
<p>We’ve seen that the <code>atlas</code> data frame contains 62 different variables. You can identify the names of these 19 variables by running the <code>glimpse()</code> function from the <code>dplyr</code> package:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="wrangling.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(atlas)</span></code></pre></div>
<p>However, say you only need two of these variables, say <code>state</code> and <code>emp2000</code>. You can <code>select()</code> these two variables:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="wrangling.html#cb46-1" aria-hidden="true" tabindex="-1"></a>atlas <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="wrangling.html#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(state, emp2000)</span></code></pre></div>
<p>This function makes exploring data frames with a very large number of variables easier for humans to process by restricting consideration to only those we care about, like our example with <code>state</code> and <code>emp2000</code> above. This might make viewing the dataset using the <code>View()</code> spreadsheet viewer more digestible. However, as far as the computer is concerned, it doesn’t care how many additional variables are in the data frame in question, so long as <code>state</code> and <code>state</code> are included.</p>
<p>Lastly, the helper functions <code>starts_with()</code>, <code>ends_with()</code>, and <code>contains()</code> can be used to select variables/column that match those conditions. For example:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="wrangling.html#cb47-1" aria-hidden="true" tabindex="-1"></a>atlas_begin_kfr <span class="ot">&lt;-</span> atlas <span class="sc">%&gt;%</span> </span>
<span id="cb47-2"><a href="wrangling.html#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&quot;kfr&quot;</span>))</span>
<span id="cb47-3"><a href="wrangling.html#cb47-3" aria-hidden="true" tabindex="-1"></a>atlas_begin_kfr</span></code></pre></div>
</div>
<div id="rename" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> <code>rename</code> variables<a href="wrangling.html#rename" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another useful function is <code>rename()</code>, which as you may have guessed renames one column to another name. Suppose we want <code>emp2000</code> and <code>popdensity2010</code> to be <code>employmentrate2000</code> and <code>populationdensity2010</code> instead in the <code>atlas</code> data frame:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="wrangling.html#cb48-1" aria-hidden="true" tabindex="-1"></a>atlas <span class="ot">&lt;-</span> atlas <span class="sc">%&gt;%</span> </span>
<span id="cb48-2"><a href="wrangling.html#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">populationdensity2010 =</span> popdensity2010,</span>
<span id="cb48-3"><a href="wrangling.html#cb48-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">employmentrate2000 =</span> emp2000)</span>
<span id="cb48-4"><a href="wrangling.html#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(atlas)</span></code></pre></div>
<p>Note that in this case we used a single <code>=</code> sign within the <code>rename()</code>. This is because we are not testing for equality like we would using <code>==</code>, but instead we want to assign a new variable <code>populationdensity2010</code> to have the same values as <code>popdensity2010</code> and then delete the variable <code>popdensity2010</code>. It’s easy to forget if the new name comes before or after the equals sign. I usually remember this as “New Before, Old After” or NBOA.</p>
</div>
<div id="top_n-values-of-a-variable" class="section level3 hasAnchor" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> <code>top_n</code> values of a variable<a href="wrangling.html#top_n-values-of-a-variable" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can also return the top <code>n</code> values of a variable using the <code>top_n()</code> function. For example, we can return a data frame of the top neighborhoods by mobility for children from parents in the percentile 25. Observe that we set the number of values to return to <code>n = 10</code> and <code>wt = kfr_pooled_p25</code> to indicate that we want the rows of corresponding to the top 10 values of <code>kfr_pooled_p25</code>. See the help file for <code>top_n()</code> by running <code>?top_n</code> for more information.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="wrangling.html#cb49-1" aria-hidden="true" tabindex="-1"></a>atlas <span class="sc">%&gt;%</span> </span>
<span id="cb49-2"><a href="wrangling.html#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">wt =</span> kfr_pooled_p25)</span></code></pre></div>
<p>Let’s further <code>arrange()</code> these results in descending order of <code>kfr_pooled_p25</code>:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="wrangling.html#cb50-1" aria-hidden="true" tabindex="-1"></a>atlas  <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="wrangling.html#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">wt =</span> kfr_pooled_p25) <span class="sc">%&gt;%</span> </span>
<span id="cb50-3"><a href="wrangling.html#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(kfr_pooled_p25))</span></code></pre></div>
<p>You can read more about the function <code>arrange()</code> <a href="https://nustat.github.io/intro-stat-ds/4-tidy.html">here</a>, but the logic is fairly simple. We are organizing the neighborhoods in descending order in the variable <code>kfr_pooled_p25</code>.</p>
<hr />
</div>
</div>
<div id="conclusion-2" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Conclusion<a href="wrangling.html#conclusion-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="additional-resources-2" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Additional resources<a href="wrangling.html#additional-resources-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!-- An R script file of all R code used in this chapter is available [here](scripts/04-wrangling.R). -->
<p>If you want to further unlock the power of the <code>dplyr</code> package for data wrangling, we suggest you that you check out RStudio’s “Data Transformation with dplyr” cheatsheet. This cheatsheet summarizes much more than what we’ve discussed in this chapter, in particular more-intermediate level and advanced data wrangling functions, while providing quick and easy to read visual descriptions.</p>
<p>You can access this cheatsheet by going to the RStudio Menu Bar -&gt; Help -&gt; Cheatsheets -&gt; “Data Transformation with dplyr”:</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:dplyr-cheatsheet"></span>
<img src="images/dplyr_cheatsheet-1.png" alt="Data Transformation with dplyr cheatsheat" width="\textwidth" />
<p class="caption">
Figure 4.4: Data Transformation with dplyr cheatsheat
</p>
</div>
<p>On top of data wrangling verbs and examples we presented in this section, if you’d like to see more examples of using the <code>dplyr</code> package for data wrangling check out <a href="http://r4ds.had.co.nz/transform.html">Chapter 5</a> of Garrett Grolemund and Hadley Wickham’s and Garrett’s book <span class="citation">(<a href="#ref-rds2016" role="doc-biblioref"><strong>rds2016?</strong></a>)</span>.</p>
<!--
Review questions have been designed using the `fivethirtyeight` R package [@R-fivethirtyeight] with links to the corresponding FiveThirtyEight.com articles in our free DataCamp course **Effective Data Storytelling using the `tidyverse`**.  The material in this chapter is covered in the chapters of the DataCamp course available below:

- [Filtering, Grouping, & Summarizing](https://campus.datacamp.com/courses/effective-data-storytelling-using-the-tidyverse-free/17585?ex=1)
- [dplyr Review](https://campus.datacamp.com/courses/effective-data-storytelling-using-the-tidyverse-free/17586?ex=1)
-->

</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="viz.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="appendixA.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/03-wrangling.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
